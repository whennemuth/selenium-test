<form name="configfrm" action="" method="post" novalidate>
<div class=floatingbox>
	<div class=sectionlabel>Current User</div>
	<div class=sectionarea>
		<div class=fieldlabel align="right">
			User ID: {{config.user.id}}
		</div>
		<div class=fieldlabel>First name</div>
		<div style="padding-bottom: 5px;">
			<input required name="firstname" type="text" ng-model="config.user.firstName">
		</div>
		<div class=fieldlabel>Last name</div>
		<div style="padding-bottom: 5px;">
			<input required name="lastname" type="text" ng-model="config.user.lastName">
		</div>
	</div>
	
	<div class=sectionlabel>Environments</div>
	<div class=sectionarea>
		<div class=fieldlabel>Servers</div>
		<div>
			<select 
				required
				name="server" 
				size="5" 
				style="width:180px;"
				ng-change="setConfig();"
				ng-model="config.currentEnvironment"
				ng-options="environment.name 
							for environment in config.configEnvironments 
							track by environment.url">
			</select>
		</div>
		<div class=fieldlabel>Name</div>
		<div>
			<input 
				required 
				name="servername" 
				type='text' 
				ng-model="config.currentEnvironment.name" >
		</div>
		<div class=fieldlabel>URL</div>
		<div>
			<input 
				required 
				name="serverurl" 
				type='text' 
				ng-model="config.currentEnvironment.url">
		</div>
		
		<!-- Need to include remaining environment attributes so that config.currentEnvironment will be fully binded -->
		<input name="serverid" type='hidden' ng-model="config.currentEnvironment.id">
		<input name="servertrans" type='hidden' ng-model="config.currentEnvironment.transitory">
		<input name="servercurrent" type='hidden' ng-model="config.currentEnvironment.current">
		<input name="parentConfig" type='hidden' ng-model="config.currentEnvironment.parentConfig">
		
		<div align=right style='margin: 5px;'>
			<input 
				type='button' 
				value='Add' 
				style='padding:5px;'
				ng-disabled="configfrm.servername.$error.required || 
							 configfrm.serverurl.$error.required"
				ng-click="setConfig('add environment');">
				
			<input 
				type='button' 
				value='Edit' 
				style='padding:5px;'
				ng-disabled="configfrm.servername.$error.required || 
							 configfrm.serverurl.$error.required"
				ng-click="setConfig('edit environment');">
				
			<input 
				type='button' 
				value='Remove' 
				style='padding:5px;'
				ng-disabled="configfrm.server.$error.required" 
				ng-click="setConfig('remove environment');">
		</div>
	</div>	
</div>


<div class="floatingbox width400">
	<div class=sectionlabel>Head selection</div>
	<div class=sectionarea>
		<div style="float:right; width:250px; height:45px; border: solid 1px #007acc;">
			<div class="basicfont pad5" ng-show="!config.headless">Desktop use. A browser will appear and the script will run in it as you watch.</div>
			<div class="basicfont pad5" ng-show="config.headless">Build use. To be run by another process against a virtual, in memory browser. Use this to test how Jenkins might run scripts created for desktop use.</div>
		</div>
		<div class="fieldlabel"><input 
			name="browser" 
			type='radio'
			ng-model="config.headless"
			ng-value="false"
			ng-click="setConfig();">Use Browser</div>
		<div class="fieldlabel"><input 
			name="browser" 
			type='radio'
			ng-model="config.headless"
			ng-value="true"
			ng-click="setConfig();">Headless Mode</div>
	</div>
	
	
	<div class=sectionlabel>Module definitions</div>
	<div class=sectionarea>
		<div ng-repeat="m in config.configModules" style="padding-top:5px;">
			<input 
				type="checkbox" 
				ng-model="config.configModules[$index].checked"> 
			<input 
				type="text" 
				style="width:200px" 
				ng-model="m.label"> 
	    	<input 
	    		type="button" 
	    		value="add"
	    		ng-disabled="!m.label" 
	    		ng-click="insertNewModule($index);">		    
			<input 
				type="button" 
				value="remove" 
				ng-click="config.configModules.splice($index, 1);">
			<div 
				ng-repeat="t in m.configTabs" 
				style="padding-left:50px; padding-top: {{$index==0 ? '5px;' : '0px;'}}" 
				ng-show="config.configModules[$parent.$index].checked">
				<input 
					type="text" 
					style="width:200px" 
					ng-model="t.label"> 
	    		<input 
	    			type="button" value="add" 
	    			ng-disabled="!t.label" 
	    			ng-click="insertNewTab($parent.$index, $index);">		    
				<input 
					type="button" 
					value="remove" 
					ng-show="config.configModules[$parent.$index].configTabs.length > 1"
					ng-click="config.configModules[$parent.$index].configTabs.splice($index, 1);">
			</div>
		</div>
	</div>
	
	
	<div class=sectionlabel>Shortcuts</div>
	<div class=sectionarea>
		<div style="float:right; width:250px; height:45px; border: solid 1px #007acc;">
			<div class="basicfont pad5">A shortcut is a pre-defined method for locating and clicking a link. The link can be located under a label heading, which is under its own larger heading, and so on.</div>
		</div>
		<div ng-repeat="sc in config.configShortcuts" style="padding-top:5px;">
			<input 
				type="checkbox" 
				ng-model="config.configShortcuts[$index].checked"> 
			<input 
				required name="shortcutname" 
				style="width:200px"
				type='text' 
				ng-model="sc.name" >
	    	<input 
	    		type="button" 
	    		value="add"
	    		title="Add a heading label"
	    		ng-disabled="!sc.name" 
	    		ng-click="insertNewShortcut($index);">		    
			<input 
				type="button" 
				value="remove" 
				ng-click="sc.configShortcuts.splice($index, 1);">
			<div 
				style="padding-left:50px; padding-top: {{$index==0 ? '5px;' : '0px;'}}" 
				ng-show="config.configShortcuts[$parent.$index].checked">
				<input type="text" style="width:200px" 
					ng-model="sc.labelHierarchyObject.name"> 
	    		<input 
	    			type="button" value=" > label " 
	    			title="Add a sub-heading label"
	    			ng-disabled="!sc.labelHierarchyObject.name" 
	    			ng-click="insertShortcutSubHeading(sc.labelHierarchyObject);">		    
	    		<input 
	    			type="button" value=" | link " 
	    			title="Terminate the shortcut with a link"
	    			ng-disabled="!sc.labelHierarchyObject.name" 
	    			ng-click="insertShortcutLink(sc.labelHierarchyObject);">		    
				<input 
					type="button" 
					value="remove" 
					ng-click="sc.labelHierarchyObject = null;">
			</div>
		</div>
	
	</div>
	
	<div class=sectionarea align="right" style="border:none;">
		<input 
			type="button" 
			value=" SAVE " 
			class="bigbutton"
			ng-disabled="configfrm.firstname.$error.required || 
						 configfrm.lastname.$error.required" 
			ng-click="setConfig('save config');">
	</div>
</div>

<div class=floatingbox style="clear:both">
	<textarea cols="80" rows=20 ng-show="showJson()">{{getConfigJson()}}</textarea>
</div>
</form>